<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>3D Swipe + Tilt Item Preview</title>

<style>
    body {
        margin: 0;
        background: #0b0f19;
        font-family: "Segoe UI", sans-serif;
        color: white;
        display: flex;
        flex-direction: column;
        align-items: center;
        overflow: hidden;
    }

    h1 {
        margin-top: 12px;
        font-size: 1.3rem;
        text-shadow: 0 0 8px cyan;
    }

    .preview-area {
        width: 90%;
        max-width: 420px;
        height: 380px;
        margin-top: 20px;
        perspective: 1000px;
    }

    .preview-box {
        width: 100%;
        height: 100%;
        background: rgba(255,255,255,0.06);
        border: 1px solid rgba(255,255,255,0.15);
        border-radius: 14px;
        backdrop-filter: blur(6px);
        box-shadow: 0 0 20px rgba(0,255,255,0.2);
        display: flex;
        align-items: center;
        justify-content: center;
        transition: transform 0.15s ease-out;
        position: relative;
        overflow: hidden;
    }

    .preview-box img {
        max-width: 85%;
        max-height: 85%;
        transition: transform 0.2s ease-out;
        pointer-events: none;
    }

    .btn {
        margin-top: 14px;
        padding: 10px 18px;
        border-radius: 10px;
        font-size: 1rem;
        color: black;
        background: cyan;
        border: none;
        font-weight: bold;
        text-shadow: 0 0 5px white;
        box-shadow: 0 0 10px cyan;
    }

    .dots {
        display: flex;
        gap: 8px;
        margin-top: 12px;
    }
    .dot {
        width: 12px;
        height: 12px;
        background: rgba(255,255,255,0.3);
        border-radius: 50%;
        transition: 0.2s;
    }
    .dot.active {
        background: cyan;
        box-shadow: 0 0 10px cyan;
    }
</style>
</head>
<body>

<h1>3D Swipe + Tilt Item Preview</h1>

<button id="btnPermission" class="btn">Enable Motion Control</button>

<div class="preview-area">
    <div class="preview-box" id="previewBox">
        <img id="previewImg" src="item1.png">
    </div>
</div>

<div class="dots" id="dots"></div>

<script>
// ===========================================
// IMAGE LIST — ADD ALL YOUR PNG IMAGES HERE
// ===========================================
const items = [
    "Kohane.jpg",
    "Haruka.jpg",
    "jpcity.jfif"
];

// DOM refs
const previewImg = document.getElementById("previewImg");
const previewBox = document.getElementById("previewBox");
const dots = document.getElementById("dots");
const btnPermission = document.getElementById("btnPermission");

let index = 0;
let tiltEnabled = false;

// Display dots
function renderDots(){
    dots.innerHTML = "";
    items.forEach((_,i)=>{
        let d=document.createElement("div");
        d.className = "dot"+(i===index?" active":"");
        d.onclick =()=>{ index=i; updateImage(); };
        dots.appendChild(d);
    });
}
function updateImage(){
    previewImg.src = items[index];
    renderDots();
}
renderDots();

// ===========================================
// FINGER SWIPE – also rotates 3D
// ===========================================
let startX = 0;
let isSwiping = false;

previewBox.addEventListener("touchstart",(e)=>{
    startX = e.touches[0].clientX;
    isSwiping = true;
});
previewBox.addEventListener("touchmove",(e)=>{
    if (!isSwiping) return;
    let diff = e.touches[0].clientX - startX;

    // rotate item while sliding
    previewBox.style.transform = `rotateY(${diff/3}deg)`;
    previewImg.style.transform = `rotateY(${diff/6}deg) scale(1.05)`;

    if(Math.abs(diff)>60){
        if(diff<0){ nextItem(); }
        else { prevItem(); }
        isSwiping=false;
    }
});
previewBox.addEventListener("touchend",()=>{
    isSwiping=false;
    previewBox.style.transform="";
    previewImg.style.transform="";
});

function nextItem(){
    index = (index+1) % items.length;
    updateImage();
}
function prevItem(){
    index = (index-1+items.length) % items.length;
    updateImage();
}

// ===========================================
// DEVICE ORIENTATION (needs permission on iOS)
// ===========================================
btnPermission.onclick = async ()=>{
    if (typeof DeviceOrientationEvent.requestPermission === "function") {
        // iOS
        const resp = await DeviceOrientationEvent.requestPermission();
        if(resp==="granted"){
            enableTilt();
            btnPermission.innerText = "Motion Enabled ✓";
            btnPermission.style.background="lime";
        }
    } else {
        // Android/Desktop
        enableTilt();
        btnPermission.innerText = "Motion Enabled ✓";
        btnPermission.style.background="lime";
    }
};

function enableTilt(){
    tiltEnabled = true;
    window.addEventListener("deviceorientation",(e)=>{
        if(!tiltEnabled) return;
        let x = e.beta || 0; 
        let y = e.gamma || 0;

        // clamp values for safety
        if(x>45) x=45; if(x<-45) x=-45;
        if(y>45) y=45; if(y<-45) y=-45;

        previewBox.style.transform =
            `rotateX(${x * -0.3}deg) rotateY(${y * 0.4}deg)`;

        previewImg.style.transform =
            `rotateX(${x * -0.15}deg) rotateY(${y * 0.2}deg) scale(1.05)`;
    });
}
</script>

</body>
</html>
